//CREATE


image_alpha = 0;
playable = false;
snapspeed = 10;
fadespeed = 0.02;
standby_y = 240;
dboxready = false;


//STEP

#region Debugging tool for activating dialog mode

//if (keyboard_check_pressed(ord("P"))) dialogstate = !dialogstate;

#endregion


#region detecting camera
if (instance_exists(obj_camera)) {
	var camid = (instance_find(obj_camera,0));
	playable = true;
}
#endregion

#region Keeping horizontal center
if (playable) id.x = camid.x;
else id.x = room_width/2;
#endregion

#region the dialog state
if (obj_dialogmanager.dialoguestatus) {
	
	if (id.y != obj_camera.y) {
		var dboxpos_y = (obj_camera.y+standby_y);
		id.y += (dboxpos_y-id.y)/snapspeed;
	}
	if (image_alpha < 1) image_alpha += fadespeed;
	else {
		image_alpha = 1;
		dboxready = true;
	}
} else {
	
	if ((id.y != (obj_camera.y-standby_y)) && (image_alpha < 0.8)) {
		var belowgap = room_height + standby_y;
		id.y += ((belowgap)-id.y)/(snapspeed);
	}
	if (image_alpha > 0) image_alpha -= (fadespeed);
	else {
		image_alpha = 0;
		dboxready = false;
	}
}

#endregion
